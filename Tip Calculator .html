<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tip Calculator & Splitter</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#4CAF50', // Green
                        'primary-dark': '#388E3C',
                        'secondary': '#FF9800', // Orange/Amber
                        'background': '#F9FAFB', // Light Gray background
                        'card': '#FFFFFF',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom styles for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #eef2f6; /* Soft blue-gray background */
        }
        .input-box {
            @apply w-full p-3 border-2 border-gray-200 rounded-xl focus:ring-primary focus:border-primary transition duration-150 text-xl font-semibold text-gray-800;
        }
        .tip-button {
            @apply px-4 py-2 rounded-xl text-lg font-medium bg-gray-100 text-gray-700 hover:bg-primary hover:text-white transition duration-150 flex-grow;
        }
        .tip-button.active {
            @apply bg-primary text-white shadow-lg;
        }
    </style>
</head>
<body>

<div class="w-full max-w-lg mx-auto p-6 md:p-10 bg-card shadow-2xl rounded-3xl transform hover:shadow-primary/20 transition-all duration-300">
    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-8 text-center border-b-2 pb-3 border-primary/20">
        Tip & Bill Splitter
    </h1>

    <!-- 1. Bill Amount Input -->
    <div class="mb-6">
        <label for="bill-amount" class="block text-sm font-semibold text-gray-700 mb-2">Bill Amount ($)</label>
        <input type="number" id="bill-amount" value="50.00" min="0.01" step="0.01" class="input-box" placeholder="e.g., 50.00" oninput="calculateTip()">
    </div>

    <!-- 2. Tip Percentage Selection -->
    <div class="mb-6">
        <label class="block text-sm font-semibold text-gray-700 mb-3">Select Tip Percentage</label>
        <div class="flex flex-wrap gap-2">
            <!-- Predefined Buttons -->
            <button class="tip-button active" data-tip="15" onclick="setTip(15, this)">15%</button>
            <button class="tip-button" data-tip="18" onclick="setTip(18, this)">18%</button>
            <button class="tip-button" data-tip="20" onclick="setTip(20, this)">20%</button>
        </div>
    </div>

    <!-- 3. Custom Tip Input -->
    <div class="mb-6">
        <label for="custom-tip" class="block text-sm font-semibold text-gray-700 mb-2">Custom Tip % (Optional)</label>
        <input type="number" id="custom-tip" min="0" max="100" class="input-box" placeholder="e.g., 25" oninput="setCustomTip(this.value, this)">
    </div>

    <!-- 4. Split Bill Feature -->
    <div class="mb-8">
        <label for="party-size" class="block text-sm font-semibold text-gray-700 mb-2">Number of People to Split</label>
        <input type="number" id="party-size" value="1" min="1" class="input-box" placeholder="Minimum 1" oninput="calculateTip()">
    </div>

    <!-- 5. Results Display -->
    <div class="p-6 bg-primary/10 rounded-2xl shadow-inner">
        <h2 class="text-xl font-bold text-primary-dark mb-4">Calculation Results</h2>
        
        <div class="flex justify-between items-center py-2 border-b border-primary/20">
            <span class="text-lg text-gray-700">Tip Amount:</span>
            <span id="tip-amount-display" class="text-2xl font-extrabold text-primary">$7.50</span>
        </div>

        <div class="flex justify-between items-center py-2 border-b border-primary/20">
            <span class="text-lg text-gray-700">Total Bill (with tip):</span>
            <span id="total-amount-display" class="text-2xl font-extrabold text-primary-dark">$57.50</span>
        </div>

        <div class="flex justify-between items-center pt-3 mt-2">
            <span class="text-xl font-bold text-gray-800">Amount Per Person:</span>
            <span id="per-person-display" class="text-3xl font-extrabold text-secondary">$57.50</span>
        </div>
    </div>
</div>

<script>
    // Global variable to store the currently selected tip percentage
    let currentTipPercentage = 15;

    // Helper function for currency formatting
    const formatter = new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
    });

    /**
     * Sets the tip percentage when a predefined button is clicked.
     * @param {number} percentage The tip percentage value (e.g., 15).
     * @param {HTMLElement} element The button element that was clicked.
     */
    function setTip(percentage, element) {
        currentTipPercentage = percentage;

        // Clear custom tip input
        document.getElementById('custom-tip').value = '';

        // Update active class on buttons
        document.querySelectorAll('.tip-button').forEach(btn => {
            btn.classList.remove('active');
        });
        element.classList.add('active');
        
        calculateTip();
    }

    /**
     * Sets the tip percentage from the custom input field.
     * @param {string} value The value from the custom input field.
     * @param {HTMLElement} element The custom input element.
     */
    function setCustomTip(value, element) {
        // Clear active state on predefined buttons
        document.querySelectorAll('.tip-button').forEach(btn => {
            btn.classList.remove('active');
        });

        const customTip = parseFloat(value);
        if (!isNaN(customTip) && customTip >= 0) {
            currentTipPercentage = customTip;
        } else {
            // If custom tip is cleared or invalid, fall back to a default (e.g., 0) or the last button value.
            // For simplicity, we'll let calculateTip handle the 0 case if the field is empty.
        }
        
        calculateTip();
    }


    /**
     * Main function to perform all calculations and update the display.
     */
    function calculateTip() {
        // 1. Get inputs
        const billInput = document.getElementById('bill-amount');
        const partyInput = document.getElementById('party-size');
        const customTipInput = document.getElementById('custom-tip');

        // Check if the custom tip field has a value, override currentTipPercentage if it does.
        const customTipValue = parseFloat(customTipInput.value);
        let effectiveTipPercentage = currentTipPercentage;
        
        if (!isNaN(customTipValue) && customTipValue >= 0) {
            effectiveTipPercentage = customTipValue;
        } else if (customTipInput.value === '') {
             // If custom tip is empty, stick to the button-selected percentage.
        }

        // Parse bill and party size, defaulting to 0 or 1 for safe calculations
        const billAmount = parseFloat(billInput.value) || 0;
        const partySize = parseInt(partyInput.value) || 1; 

        // Input validation and sanitation
        if (billAmount <= 0) {
            // Set all outputs to zero or $0.00 if bill is invalid
            document.getElementById('tip-amount-display').textContent = formatter.format(0);
            document.getElementById('total-amount-display').textContent = formatter.format(0);
            document.getElementById('per-person-display').textContent = formatter.format(0);
            return;
        }

        // Ensure party size is at least 1
        if (partySize < 1) {
            partyInput.value = 1;
        }

        // 2. Calculate Tip and Total
        const tipRate = effectiveTipPercentage / 100;
        const tipAmount = billAmount * tipRate;
        const totalAmount = billAmount + tipAmount;
        
        // 3. Calculate Split
        const perPersonAmount = totalAmount / partySize;

        // 4. Display Results with Currency Formatting
        document.getElementById('tip-amount-display').textContent = formatter.format(tipAmount);
        document.getElementById('total-amount-display').textContent = formatter.format(totalAmount);
        document.getElementById('per-person-display').textContent = formatter.format(perPersonAmount);
    }

    // Initialize calculation on load
    window.onload = function() {
        calculateTip();
    };

</script>
</body>
</html>